{"version":3,"file":"visual-modeller-core.min.js","sources":["../src/model/Link.js","../src/model/Log.js","../src/model/Model.js","../src/model/Node.js","../src/model/Socket.js"],"sourcesContent":["class Link {\n    constructor(options) {\n        this.socket1 = options.socket1 || null;\n        this.socket2 = options.socket2 || null;\n        this.state = options.state || {};\n    }\n\n    getOtherSocket(socket) {\n        if (socket === this.socket1) {\n            return this.socket2;\n        } else if (socket === this.socket2) {\n            return this.socket1;\n        } else {\n            return null;\n        }\n    }\n}\n\nexport { Link };","class Log {\n    constructor(options) {\n        this.name = options.name || 'log';\n        this.target = options.target || null;\n        this.states = [];\n    }\n\n    writeToLog() {\n        this.states.push({...this.target.state});\n    }\n\n    clear() {\n        this.states = [];\n    }\n}\n\nexport { Log };","class Model {\n    constructor(options) {\n        this.nodes = options.nodes || [];\n        this.links = options.links || [];\n        this.logs = options.logs || [];\n        this.maxNodeId = 0;\n        this.maxLinkId = 0;\n        this.maxLogId = 0;\n    }\n\n    getNodeId() {\n        let newNodeId = `node-${this.maxNodeId}`;\n        this.maxNodeId++;\n        return newNodeId;\n    }\n\n    getLinkId() {\n        let newLinkId = `link-${this.maxLinkId}`;\n        this.maxLinkId++;\n        return newLinkId;\n    }\n\n    getLogId() {\n        let newLogId = `log-${this.maxLogId}`;\n        this.maxLogId++;\n        return newLogId;\n    }\n\n    addNode(node) {\n        node.id = this.getNodeId();\n        this.nodes.push(node);\n    }\n\n    addLink(link) {\n        link.id = this.getLinkId();\n        const s1 = link.socket1;\n        s1.link = link;\n        s1.otherSocket = link.socket2;\n        const s2 = link.socket2;\n        s2.link = link;\n        s2.otherSocket = link.socket1;\n        this.links.push(link);\n    }\n\n    addLog(log) {\n        log.id = this.getLogId();\n        this.logs.push(log);\n    }\n\n    removeNode(node) {\n        this.nodes = this.nodes.filter(n => n !== node);\n    }\n\n    removeLink(link) {\n        this.links = this.links.filter(l => l !== link);\n    }\n\n    removeLog(log) {\n        this.logs = this.logs.filter(l => l !== log);\n    }\n\n    removeNodeById(id) {\n        this.nodes = this.nodes.filter(n => n.id !== id);\n    }\n\n    removeLinkById(id) {\n        this.links = this.links.filter(l => l.id !== id);\n    }\n\n    removeLogById(id) {\n        this.logs = this.logs.filter(l => l.id !== id);\n    }\n\n    clearLogs() {\n        this.logs.forEach(l => l.clear());\n    }\n\n    getLinkBySocket(socket) {\n        return this.links.find(l => l.socket1 === socket || l.socket2 === socket);\n    }\n\n    getNodeBySocket(socket) {\n        return this.nodes.find(n => n.sockets.includes(socket));\n    }\n\n    getNodeClassByClassName(className) {\n        if (!this.availableNodeClasses) {\n            return null;\n        }\n        const availableNodeClassNames = this.availableNodeClasses.map(c => {\n            const instance = new c();\n            return instance.className;\n        });\n        const index = availableNodeClassNames.indexOf(className);\n        if (index === -1) {\n            return null;\n        } else {\n            return this.availableNodeClasses[index];\n        }   \n    }\n\n    toJson() {\n        const modelForJson = {};\n        modelForJson.config = this.config;\n        modelForJson.nodes = this.nodes.map(n => {\n            const nJson = {};\n            nJson.name = n.name;\n            nJson.className = n.className;\n            nJson.state = n.state;\n            nJson.sockets = n.sockets.map(s => {\n                const sJson = {};\n                sJson.name = s.name;\n                sJson.position = s.position;\n                sJson.state = s.state;\n                return sJson;\n            });\n            return nJson;\n        })\n        modelForJson.links = this.links.map(l => {\n            const lJson = {};\n            lJson.socket1 = l.socket1.name;\n            lJson.socket2 = l.socket2.name;\n            return lJson;\n        });\n        modelForJson.logs = this.logs.map(l => {\n            const lJson = {};\n            lJson.name = l.name;\n            lJson.targetId = l.target.id;\n            return lJson;\n        });\n        return JSON.stringify(modelForJson);\n    }\n\n    saveToFile() {\n        const modelJson = this.toJson();\n        const blob = new Blob([modelJson], {type: 'application/json'});\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = 'model.json';\n        a.click();\n    }\n\n\n\n\n}\n\nexport { Model };","class Node {\n    constructor(options) {\n        this.name = options.name || 'node';\n        this.sockets = [];\n        this.state = options.state || {};\n        this.maxSocketId = 0;\n        if (options.sockets) {\n            options.sockets.forEach(socket => {\n                this.addSocket(socket);\n            });\n        }\n    }\n\n    getSocketId() {\n        let newSocketId = `socket-${this.maxSocketId}`;\n        this.maxSocketId++;\n        return newSocketId;\n    }\n\n    get leftSockets() {\n        return this.sockets.filter(s => s.position === 'left');\n    }\n\n    get rightSockets() {\n        return this.sockets.filter(s => s.position === 'right');\n    }\n\n    get topSockets() {\n        return this.sockets.filter(s => s.position === 'top');\n    }\n\n    get bottomSockets() {\n        return this.sockets.filter(s => s.position === 'bottom');\n    }\n    \n    addSocket(socket) {\n        socket.id = this.getSocketId();\n        this.sockets.push(socket);\n    }\n\n    setSocketByIndex(index, socket) {\n        socket.id = this.getSocketId();\n        this.sockets[index] = socket;\n    }\n\n    getSocketByIndex(index) {\n        return this.sockets[index];\n    }\n    \n    getSocketByName(name) {\n        return this.sockets.find(s => s.name === name);\n    }\n\n    removeSocket(socket) {\n        this.sockets = this.sockets.filter(s => s !== socket);\n    }\n\n    removeSocketById(id) {\n        this.sockets = this.sockets.filter(s => s.id !== id);\n    }\n\n    removeSocketByIndex(index) {\n        this.sockets = this.sockets.filter((s, i) => i !== index);\n    }\n\n}\n\nexport { Node };\n","class Socket {\n    constructor(options) {\n        this.name = options.name || 'socket';\n        this.state = options.state || {};\n        this.position = options.position || 'left';  \n    }\n}\n\nexport { Socket };"],"names":["constructor","options","this","socket1","socket2","state","getOtherSocket","socket","name","target","states","writeToLog","push","clear","nodes","links","logs","maxNodeId","maxLinkId","maxLogId","getNodeId","newNodeId","getLinkId","newLinkId","getLogId","newLogId","addNode","node","id","addLink","link","s1","otherSocket","s2","addLog","log","removeNode","filter","n","removeLink","l","removeLog","removeNodeById","removeLinkById","removeLogById","clearLogs","forEach","getLinkBySocket","find","getNodeBySocket","sockets","includes","getNodeClassByClassName","className","availableNodeClasses","index","map","c","indexOf","toJson","modelForJson","config","nJson","s","sJson","position","lJson","targetId","JSON","stringify","saveToFile","modelJson","blob","Blob","type","url","URL","createObjectURL","a","document","createElement","href","download","click","maxSocketId","addSocket","getSocketId","newSocketId","leftSockets","rightSockets","topSockets","bottomSockets","setSocketByIndex","getSocketByIndex","getSocketByName","removeSocket","removeSocketById","removeSocketByIndex","i"],"mappings":"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"}